{"ast":null,"code":"// import React, { useEffect, useState, useContext } from \"react\";\n// import axios from \"axios\";\n// import \"./ManageUsers.css\";\n// import { AuthContext } from \"../auth/AuthContext\";\n\n// const ManageUsers = () => {\n//     const [users, setUsers] = useState([]);\n//     const [selectedUser, setSelectedUser] = useState(null);\n//     const [username, setUsername] = useState(\"\");\n//     const [email, setEmail] = useState(\"\");\n//     const [role, setRole] = useState(\"\");\n//     const [researchArea, setResearchArea] = useState(\"\"); // For professors\n//     const [password, setPassword] = useState(\"\"); // New password field\n//     const { deptId, userRole, userId } = useContext(AuthContext);\n\n//     useEffect(() => {\n//         fetchUsers();\n//     }, []);\n\n//     const fetchUsers = async () => {\n//         try {\n//             const token = localStorage.getItem(\"token\");\n//             const res = await axios.get(\"http://localhost:8800/api/users\", {\n//                 headers: { Authorization: `Bearer ${token}` }\n//             });\n\n//             // HOD/Admin should only see users from their department\n//             setUsers(res.data);\n//         } catch (err) {\n//             console.error(\"‚ùå Error fetching users:\", err);\n//             alert(\"‚ùå Failed to fetch users.\");\n//         }\n//     };\n\n//     // ‚úÖ Handle Adding a New User\n//     const handleAddUser = async (e) => {\n//         e.preventDefault(); // üö® Prevent page refresh\n\n//         try {\n//             const token = localStorage.getItem(\"token\");\n//             if (!token) {\n//                 alert(\"‚ùå Unauthorized: Please log in again.\");\n//                 return;\n//             }\n\n//             if (!deptId) {\n//                 alert(\"‚ùå Department information missing. Please re-login.\");\n//                 return;\n//             }\n\n//             const response = await axios.post(\n//                 \"http://localhost:8800/api/register\",\n//                 {\n//                     username,\n//                     email,\n//                     password,\n//                     role,\n//                     dept_id: deptId, // üîπ Use deptId from AuthContext\n//                     research_area: role === \"professor\" ? researchArea : undefined\n//                 },\n//                 { headers: { Authorization: `Bearer ${token}` } }\n//             );\n\n//             alert(\"‚úÖ User added successfully!\");\n//             console.log(response.data);\n//             fetchUsers(); // Refresh the user list\n//             resetForm();\n//         } catch (error) {\n//             console.error(\"‚ùå Error adding user:\", error.response?.data || error);\n//             alert(error.response?.data?.message || \"‚ùå Failed to add user.\");\n//         }\n//     };\n\n//     // ‚úÖ Handle Updating a User\n//     const handleUpdateUser = async () => {\n//         if (!selectedUser) return;\n\n//         try {\n//             const token = localStorage.getItem(\"token\");\n//             await axios.put(\n//                 `http://localhost:8800/api/update/${selectedUser}`,\n//                 { username, email, role },\n//                 { headers: { Authorization: `Bearer ${token}` } }\n//             );\n\n//             alert(\"‚úÖ User updated successfully!\");\n//             fetchUsers();\n//             resetForm();\n//         } catch (err) {\n//             console.error(\"‚ùå Error updating user:\", err);\n//             alert(\"‚ùå Failed to update user.\");\n//         }\n//     };\n\n//     // ‚úÖ Handle Deleting a User\n//     const handleDeleteUser = async (user_id) => {\n//         if (!window.confirm(\"Are you sure you want to delete this user?\")) return;\n//         try {\n//             const token = localStorage.getItem(\"token\");\n//             await axios.delete(`http://localhost:8800/api/delete/${user_id}`, {\n//                 headers: { Authorization: `Bearer ${token}` }\n//             });\n\n//             alert(\"‚úÖ User deleted successfully!\");\n//             fetchUsers();\n//         } catch (err) {\n//             console.error(\"‚ùå Error deleting user:\", err);\n//             alert(\"‚ùå Failed to delete user.\");\n//         }\n//     };\n\n//     // ‚úÖ Reset Form Fields\n//     const resetForm = () => {\n//         setUsername(\"\");\n//         setEmail(\"\");\n//         setRole(\"\");\n//         setResearchArea(\"\");\n//         setPassword(\"\");\n//         setSelectedUser(null);\n//     };\n\n//     return (\n//         <div className=\"manage-users-container\">\n//             <h2>Manage Users</h2>\n\n//             {/* Add User Form */}\n//             <div className=\"user-form\">\n//                 <h3>Add New User</h3>\n//                 <form onSubmit={handleAddUser}>\n//                     <input type=\"text\" placeholder=\"Username\" value={username} onChange={(e) => setUsername(e.target.value)} required />\n//                     <input type=\"email\" placeholder=\"Email\" value={email} onChange={(e) => setEmail(e.target.value)} required />\n//                     <input type=\"password\" placeholder=\"Password\" value={password} onChange={(e) => setPassword(e.target.value)} required />\n//                     <select value={role} onChange={(e) => setRole(e.target.value)} required>\n//                         <option value=\"\">Select Role</option>\n//                         <option value=\"admin\">Admin</option>\n//                         <option value=\"professor\">Professor</option>\n//                     </select>\n//                     {role === \"professor\" && (\n//                         <input type=\"text\" placeholder=\"Research Area (Optional)\" value={researchArea} onChange={(e) => setResearchArea(e.target.value)} />\n//                     )}\n//                     <button type=\"submit\">Add User</button>\n//                 </form>\n//             </div>\n\n//             {/* User List */}\n//             <h3>Users List</h3>\n//             <table className=\"users-table\">\n//                 <thead>\n//                     <tr>\n//                         <th>Username</th>\n//                         <th>Email</th>\n//                         <th>Role</th>\n//                         <th>Actions</th>\n//                     </tr>\n//                 </thead>\n//                 <tbody>\n//                     {users.map((user) => (\n//                         <tr key={user.user_id}>\n//                             <td>{user.user_name}</td>\n//                             <td>{user.user_email}</td>\n//                             <td>{user.role}</td>\n//                             <td>\n//                                 <button onClick={() => { setSelectedUser(user.user_id); setUsername(user.user_name); setEmail(user.user_email); setRole(user.role); }}>‚úèÔ∏è Edit</button>\n//                                 <button onClick={() => handleDeleteUser(user.user_id)}>üóëÔ∏è Delete</button>\n//                             </td>\n//                         </tr>\n//                     ))}\n//                 </tbody>\n//             </table>\n\n//             {/* Update User Section */}\n//             {selectedUser && (\n//                 <div className=\"user-form\">\n//                     <h3>Update User</h3>\n//                     <input type=\"text\" placeholder=\"Username\" value={username} onChange={(e) => setUsername(e.target.value)} required />\n//                     <input type=\"email\" placeholder=\"Email\" value={email} onChange={(e) => setEmail(e.target.value)} required />\n//                     <select value={role} onChange={(e) => setRole(e.target.value)} required>\n//                         <option value=\"admin\">Admin</option>\n//                         <option value=\"professor\">Professor</option>\n//                     </select>\n//                     <button onClick={handleUpdateUser}>Update User</button>\n//                 </div>\n//             )}\n//         </div>\n//     );\n// };\n\n// export default ManageUsers;","map":{"version":3,"names":[],"sources":["C:/Users/om/Desktop/uims - Copy/client/src/pages/ManageUsers.jsx"],"sourcesContent":["// import React, { useEffect, useState, useContext } from \"react\";\r\n// import axios from \"axios\";\r\n// import \"./ManageUsers.css\";\r\n// import { AuthContext } from \"../auth/AuthContext\";\r\n\r\n// const ManageUsers = () => {\r\n//     const [users, setUsers] = useState([]);\r\n//     const [selectedUser, setSelectedUser] = useState(null);\r\n//     const [username, setUsername] = useState(\"\");\r\n//     const [email, setEmail] = useState(\"\");\r\n//     const [role, setRole] = useState(\"\");\r\n//     const [researchArea, setResearchArea] = useState(\"\"); // For professors\r\n//     const [password, setPassword] = useState(\"\"); // New password field\r\n//     const { deptId, userRole, userId } = useContext(AuthContext);\r\n\r\n//     useEffect(() => {\r\n//         fetchUsers();\r\n//     }, []);\r\n    \r\n//     const fetchUsers = async () => {\r\n//         try {\r\n//             const token = localStorage.getItem(\"token\");\r\n//             const res = await axios.get(\"http://localhost:8800/api/users\", {\r\n//                 headers: { Authorization: `Bearer ${token}` }\r\n//             });\r\n\r\n//             // HOD/Admin should only see users from their department\r\n//             setUsers(res.data);\r\n//         } catch (err) {\r\n//             console.error(\"‚ùå Error fetching users:\", err);\r\n//             alert(\"‚ùå Failed to fetch users.\");\r\n//         }\r\n//     };\r\n\r\n//     // ‚úÖ Handle Adding a New User\r\n//     const handleAddUser = async (e) => {\r\n//         e.preventDefault(); // üö® Prevent page refresh\r\n\r\n//         try {\r\n//             const token = localStorage.getItem(\"token\");\r\n//             if (!token) {\r\n//                 alert(\"‚ùå Unauthorized: Please log in again.\");\r\n//                 return;\r\n//             }\r\n\r\n//             if (!deptId) {\r\n//                 alert(\"‚ùå Department information missing. Please re-login.\");\r\n//                 return;\r\n//             }\r\n\r\n//             const response = await axios.post(\r\n//                 \"http://localhost:8800/api/register\",\r\n//                 {\r\n//                     username,\r\n//                     email,\r\n//                     password,\r\n//                     role,\r\n//                     dept_id: deptId, // üîπ Use deptId from AuthContext\r\n//                     research_area: role === \"professor\" ? researchArea : undefined\r\n//                 },\r\n//                 { headers: { Authorization: `Bearer ${token}` } }\r\n//             );\r\n\r\n//             alert(\"‚úÖ User added successfully!\");\r\n//             console.log(response.data);\r\n//             fetchUsers(); // Refresh the user list\r\n//             resetForm();\r\n//         } catch (error) {\r\n//             console.error(\"‚ùå Error adding user:\", error.response?.data || error);\r\n//             alert(error.response?.data?.message || \"‚ùå Failed to add user.\");\r\n//         }\r\n//     };\r\n\r\n//     // ‚úÖ Handle Updating a User\r\n//     const handleUpdateUser = async () => {\r\n//         if (!selectedUser) return;\r\n\r\n//         try {\r\n//             const token = localStorage.getItem(\"token\");\r\n//             await axios.put(\r\n//                 `http://localhost:8800/api/update/${selectedUser}`,\r\n//                 { username, email, role },\r\n//                 { headers: { Authorization: `Bearer ${token}` } }\r\n//             );\r\n\r\n//             alert(\"‚úÖ User updated successfully!\");\r\n//             fetchUsers();\r\n//             resetForm();\r\n//         } catch (err) {\r\n//             console.error(\"‚ùå Error updating user:\", err);\r\n//             alert(\"‚ùå Failed to update user.\");\r\n//         }\r\n//     };\r\n\r\n//     // ‚úÖ Handle Deleting a User\r\n//     const handleDeleteUser = async (user_id) => {\r\n//         if (!window.confirm(\"Are you sure you want to delete this user?\")) return;\r\n//         try {\r\n//             const token = localStorage.getItem(\"token\");\r\n//             await axios.delete(`http://localhost:8800/api/delete/${user_id}`, {\r\n//                 headers: { Authorization: `Bearer ${token}` }\r\n//             });\r\n\r\n//             alert(\"‚úÖ User deleted successfully!\");\r\n//             fetchUsers();\r\n//         } catch (err) {\r\n//             console.error(\"‚ùå Error deleting user:\", err);\r\n//             alert(\"‚ùå Failed to delete user.\");\r\n//         }\r\n//     };\r\n\r\n//     // ‚úÖ Reset Form Fields\r\n//     const resetForm = () => {\r\n//         setUsername(\"\");\r\n//         setEmail(\"\");\r\n//         setRole(\"\");\r\n//         setResearchArea(\"\");\r\n//         setPassword(\"\");\r\n//         setSelectedUser(null);\r\n//     };\r\n\r\n//     return (\r\n//         <div className=\"manage-users-container\">\r\n//             <h2>Manage Users</h2>\r\n\r\n//             {/* Add User Form */}\r\n//             <div className=\"user-form\">\r\n//                 <h3>Add New User</h3>\r\n//                 <form onSubmit={handleAddUser}>\r\n//                     <input type=\"text\" placeholder=\"Username\" value={username} onChange={(e) => setUsername(e.target.value)} required />\r\n//                     <input type=\"email\" placeholder=\"Email\" value={email} onChange={(e) => setEmail(e.target.value)} required />\r\n//                     <input type=\"password\" placeholder=\"Password\" value={password} onChange={(e) => setPassword(e.target.value)} required />\r\n//                     <select value={role} onChange={(e) => setRole(e.target.value)} required>\r\n//                         <option value=\"\">Select Role</option>\r\n//                         <option value=\"admin\">Admin</option>\r\n//                         <option value=\"professor\">Professor</option>\r\n//                     </select>\r\n//                     {role === \"professor\" && (\r\n//                         <input type=\"text\" placeholder=\"Research Area (Optional)\" value={researchArea} onChange={(e) => setResearchArea(e.target.value)} />\r\n//                     )}\r\n//                     <button type=\"submit\">Add User</button>\r\n//                 </form>\r\n//             </div>\r\n\r\n//             {/* User List */}\r\n//             <h3>Users List</h3>\r\n//             <table className=\"users-table\">\r\n//                 <thead>\r\n//                     <tr>\r\n//                         <th>Username</th>\r\n//                         <th>Email</th>\r\n//                         <th>Role</th>\r\n//                         <th>Actions</th>\r\n//                     </tr>\r\n//                 </thead>\r\n//                 <tbody>\r\n//                     {users.map((user) => (\r\n//                         <tr key={user.user_id}>\r\n//                             <td>{user.user_name}</td>\r\n//                             <td>{user.user_email}</td>\r\n//                             <td>{user.role}</td>\r\n//                             <td>\r\n//                                 <button onClick={() => { setSelectedUser(user.user_id); setUsername(user.user_name); setEmail(user.user_email); setRole(user.role); }}>‚úèÔ∏è Edit</button>\r\n//                                 <button onClick={() => handleDeleteUser(user.user_id)}>üóëÔ∏è Delete</button>\r\n//                             </td>\r\n//                         </tr>\r\n//                     ))}\r\n//                 </tbody>\r\n//             </table>\r\n\r\n//             {/* Update User Section */}\r\n//             {selectedUser && (\r\n//                 <div className=\"user-form\">\r\n//                     <h3>Update User</h3>\r\n//                     <input type=\"text\" placeholder=\"Username\" value={username} onChange={(e) => setUsername(e.target.value)} required />\r\n//                     <input type=\"email\" placeholder=\"Email\" value={email} onChange={(e) => setEmail(e.target.value)} required />\r\n//                     <select value={role} onChange={(e) => setRole(e.target.value)} required>\r\n//                         <option value=\"admin\">Admin</option>\r\n//                         <option value=\"professor\">Professor</option>\r\n//                     </select>\r\n//                     <button onClick={handleUpdateUser}>Update User</button>\r\n//                 </div>\r\n//             )}\r\n//         </div>\r\n//     );\r\n// };\r\n\r\n// export default ManageUsers;\r\n\r\n"],"mappings":"AAAA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}